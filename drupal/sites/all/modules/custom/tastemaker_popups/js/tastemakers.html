<!-- VIDPOP=TASTEMAKER -->
<!--
This is the main HTML section; the table of thumbnails gets attached by the above javascript
-->
<div id="video-popup-grid">
  <div class="intro">Enjoy these videos below they're all from Los Angeles these videos are from Los Angeles which shouldn't keep you from enjoying them even if you're not from Los Angeles.</div>
  <table class="video-thumb-table"></table>
  <div class="table-loading"></div>
</div>

<script type="text/javascript">
  // Custom script for tastemakers video page

  (function ($) {
    // the number of rows and columns
    var numRows = 2;
    var numCols = 5;

    var videoData = new Array();        // configuration data

    for (row = 0; row < numRows; row++) {
      videoData[row] = new Array();
      for (col = 0; col < numCols; col++) {
        videoData[row][col] = new Array();
      }
    }


// Don't change anything above this block!

//  ***********************************************************************
//  *** Data for the video table
//  ***
//  *** Each line has 3 fields, separated by commas, indexed
//  *** by row (0-1) and columns (0-4):
//  ***
//  ***   1) the video node id of the video
//  ***   2) the URL of the preview picture
//  ***   3) caption (for thumbnail caption or popup title)
//  ***   4) description (for popup description)
//
// Avoid using double quotes; if you must, precede them with a backslash, i.e. my \"quoted\" text

// first row
videoData[0][0] = ["31741", "http://www.takepart.com/sites/default/files/lindy_grundy_180x136.jpeg", "L.A.'s hottest butchers: Lindy & Grundy<br />", "These two meat mavens prove that good meat comes from butchers who care about the animals they sell"];
videoData[0][1] = ["31743", "http://www.takepart.com/sites/default/files/suck_it_sweets_180x136.jpeg", "Sin-Free Sweets at Suck It", "There's nothing sinful about these sweets"];
videoData[0][2] = ["31791", "http://www.takepart.com/sites/default/files/golden_road_180x136.jpeg", "Fiercely Local Beer at Golden Road Brewing", "Why beer tastes better when it's brewed nearby"];
videoData[0][3] = ["31875", "http://www.takepart.com/sites/default/files/vegenaise_180x136.jpeg", "Follow Your Heart to This Vegan Paradise", "Inside L.A.'s solar-powered vegan paradise"];
videoData[0][4] = ["31911", "http://www.takepart.com/sites/default/files/spices_180x136.jpeg", "Ditch the Factory Seasonings with Spice Station L.A.", "Ditch those factory spices to kick up the flavor of your holiday meal"];

// second row
videoData[1][0] = ["31915", "http://www.takepart.com/sites/default/files/tpduckrecipes_180x136.jpeg", "Sustainable Holiday Duck - Two Ways ", "Crispy Roasted Duck & Beer-Braised Duck Legs"];
videoData[1][1] = ["32017", "http://www.takepart.com/sites/default/files/tpsoy_180x136.jpeg", "Pumpkin (Soy) Cheesecake", "A great twist for your holiday dessert"];
videoData[1][2] = ["31919", "http://www.takepart.com/sites/default/files/tpsausagerecipes_180x136.jpeg", "Sausage and Cranberry Stuffing", "Making sausage from sustainably raised meat is a cheap way to eat right this holiday season"];
videoData[1][3] = ["31921", "http://www.takepart.com/sites/default/files/tpchard_180x136.jpeg", "Shredded Swiss Chard Salad", "Add some color to your holiday table with this bright and crisp salad"];
videoData[1][4] = ["32069", "http://www.takepart.com/sites/default/files/tpmeal_180x136.jpeg", "Our Perfect Sustainable Thanksgiving","Our ultimate sustainable holiday dinner"];


//  ***********************************************************************

// Don't change anything below this block!


    var listeners = new Array();    // list of listeners for click events

    // build the table from the data
    $(window).load(function() {
      var table = $('#video-popup-grid table.video-thumb-table');

      for (row = 0; row < numRows; row++) {
        var rc = 'r' + row;
        $(table).append('<tr class="' + rc + '"></tr>');
        for (col = 0; col < numCols; col++) {
          var cc = 'c' + col;

          // add listener for click
          (function(row_id, col_id, video_id) {  // <-- immediate function call
            if (Drupal.settings.takepart_browsercaps.detected_mobile_browser) {
              // using mobile; use native player
            }
            else {
              // desktop browser; use colorbox
              listeners[row_id + '-' + col_id] = function () { jQuery.fn.colorbox({width:"900px", height:"430px", inline:true, href:"#taste-details-" + row_id + '-' + col_id}); };
            }
          } (row, col, videoData[row][col][0])); // <-- immediate function call

          var rid = 'table tr.' + rc;
          $(rid).append('<td class="' + cc + '"></td>');

          if (Drupal.settings.takepart_browsercaps.detected_mobile_browser) {
            // mobile browser, just add the embedded video
            (function(t_row, t_col, video_id, preview_img, caption, description) {  // <-- immediate function call
              var youtube_id = unipop_video_id_from_node(video_id);
              var preview_video = '<div class="vidpop-popup tastemaker-vidpop tmvp-mobile" style="height: 136px; width: 180px;">'
                  + '<iframe width="180" height="136" frameborder="0" type="text/html" class="youtube-player tastemaker-vidpop-iframe" src="http://www.youtube.com/embed/' + youtube_id + '?version=3&amp;wmode=opaque&amp;controls=0&amp;showinfo=0" style="height: 136px; width: 180px;"></iframe>'
                  + '</div>';

              var cid = 'table tr.' + rc + ' td.' + cc;
              $(cid).append('<div class="inner tpt-' + video_id + '"><div class="vid-thumbnail">' + preview_video + '</div><div class="vid-caption">' + caption + '</div></div>');
            } (row, col, videoData[row][col][0], videoData[row][col][1], videoData[row][col][2], videoData[row][col][3])); // <-- immediate function call
          }
          else {
            // desktop, we need to add a listener slot
            (function(t_row, t_col, video_id, preview_img, caption, description) {  // <-- immediate function call
              var preview_img = '<img width="180" height="135" class="rtt-preview-img" src="' + preview_img + '" />';

              var cid = 'table tr.' + rc + ' td.' + cc;
              $(cid).append('<div class="inner tpt-video-contents tpt-' + video_id + '"><div class="vid-thumbnail">' + preview_img + '<div class="vid-arrow"></div></div><div class="vid-caption">' + caption + '</div></div>');
              $(cid).click(function() {
                // alert('cid: ' + cid + ' t_row:' + t_row +  ' t_col:' + t_col);
                showTmVideo(t_row, t_col, video_id);
                tastemakerPopupsClick(video_id);
              });
            } (row, col, videoData[row][col][0], videoData[row][col][1], videoData[row][col][2], videoData[row][col][3])); // <-- immediate function call
          }

          if (col < (numCols - 1)) {
            $(rid).append('<td class="spacer">&nbsp;</td>');
          }
        }
      }

      Drupal.attachBehaviors($(this));

      // hide the spinner
      $('#video-popup-grid .table-loading').hide();
    });

    // click handler for video thumb, non-mobile version
    function showTmVideo(r, c, val) {
      if (val != 0) {
        //alert('show  ' + r + '-' + c + '  val: ' + val);
        listeners[r + "-" + c]();
        jQuery.get("/tastemaker/video_details/" + val, function(data, video_id) {
          //alert('getting  ' + r + '::' + c + ' data: ' + data);
          jQuery("#taste-details-" + r + "-" + c + " .leftside .vidmap-inner").html(data);
        });
      }
    }
  })(jQuery);
</script>
