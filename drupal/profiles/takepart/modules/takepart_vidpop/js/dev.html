<style type="text/css">
  <!--
    /* override for existing styles */
  .region-highlighted .block-context-related-menu ul.menu, .region-highlighted .block-menu ul.menu {
    background-image: url('http://www.takepart.com/sites/default/files/rollins_header_bar_980x28_r3.jpg');
  }
  .region-highlighted .block-context-related-menu ul.menu li a, .region-highlighted .block-menu ul.menu li a {
    color: #FCE0A7;
  }
  .region-highlighted .block-context-related-menu ul.menu li a:hover, .region-highlighted .block-menu ul.menu li a:hover {
    color: #DF1A22;
  }
  .region-highlighted .block-context-related-menu ul.menu li a.active, .region-highlighted .block-menu ul.menu li a.active {
    color: #DF1A22;
    border: none;
    line-height: 28px;
  }
  -->
</style>

<!-- insert Map here -->
<!--
Configuration and display code for map page, per ticket #35777

The contents of this entire file is pasted into the body area.

TakePart's Key: AIzaSyCBqxSOBaiVARRKgOlOWIRm2lbhBeskn10
-->
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCBqxSOBaiVARRKgOlOWIRm2lbhBeskn10&sensor=false"></script>
<script type="text/javascript" src="/sites/all/libraries/google/infobox_packed.js"></script>

<script type="text/javascript">
<!--
var listeners=new Array();

function showmeamap() {
  geocoder = new google.maps.Geocoder();

  // marker and shadow images for points with videos
  var markerVideo = new google.maps.MarkerImage('/profiles/takepart/modules/takepart_vidpop/markers/vm_video.png',
    // This marker is 20 pixels wide by 32 pixels tall.
    new google.maps.Size(64, 64),
    // The origin for this image is 0,0.
    new google.maps.Point(0,0),
    // The anchor for this image is the base of the flagpole at 0,32.
    new google.maps.Point(0, 32));

  var shadowVideo = new google.maps.MarkerImage('/profiles/takepart/modules/takepart_vidpop/markers/shadow_small.png',
    new google.maps.Size(128, 128),
    new google.maps.Point(0,0),
    new google.maps.Point(-8,24));

  // marker and shadow images for points without vidoes
  var markerNormal = new google.maps.MarkerImage('/profiles/takepart/modules/takepart_vidpop/markers/vm_tooltip.png',
    // This marker is 20 pixels wide by 32 pixels tall.
    new google.maps.Size(64, 64),
    // The origin for this image is 0,0.
    new google.maps.Point(0,0),
    // The anchor for this image is the base of the flagpole at 0,32.
    new google.maps.Point(0, 32));

  var shadowNormal = new google.maps.MarkerImage('/profiles/takepart/modules/takepart_vidpop/markers/shadow_small.png',
    new google.maps.Size(128, 128),
    new google.maps.Point(0,0),
    new google.maps.Point(-8,24));

  var shape = {
    coord: [0, 0, 64, 0, 64, 64, 0, 64],
    type: 'poly'
  };

  // these defaults may be used for state and details, but won't necessarily be the most current
  var default_state = "STATE NAME";
  var default_details = "Video will be available soon";

  var addresses=new Array();

  //  **************************************************************************
  //  *** Here is where we will add the address information
  //  ***
  //  *** Each line has 5 fields, separated by commas.
  //  ***   1) the node if of the video, null if no video
  //  ***   2) the complete street address
  //  ***   3) state name
  //  ***   4) details for tooltip (if no video), or null (if video)
  //  ***

  //  *** is the complete street address. Ignore the next two. The last
  //  *** field is the text to display in the popup when no video is
  //  *** defined. Enter the node id of a video, enter an explicit text
  //  *** in quotes, or leave it as html to use boilerplate text.
  //  ***

  addresses[0]=[29897, "1680 Kapiolani Boulevard, Honolulu, HI 96814", 'HAWAII', null];
  addresses[1]=[29803, "350 Whittier Street, Juneau, AK 99801", 'ALASKA', null];
  addresses[2]=[29801, "189 Liberty St. NE, Olympia, WA 97301", 'WASHINGTON', null];
  addresses[3]=[29799, "170 High Street Southeast, Salem OR 97301", 'OREGON', null];
  addresses[4]=[29869, "1013 K Street, Sacramento, CA 95814", 'CALIFORNIA', null];
  addresses[5]=[29871, "449 West King Street, Carson City, NV 89703", 'NEVADA', null];
  addresses[6]=[29873, "308 North 2nd Avenue, Phoenix, AZ 85003", 'ARIZONA', null];
  addresses[7]=[29875, "638 South State Street, Salt Lake City, UT 84111", 'UTAH', null];
  addresses[8]=[29877, "416 South 9th Street, Boise, ID 83702", 'IDAHO', null];
  addresses[9]=[null, "15 North Ewing, Helena, MT 59601", 'MONTANA', default_details];
  addresses[10]=[null, "121 W 15th St #300, Cheyenne, WY 82001", 'WYOMING', default_details];
  addresses[11]=[null, "1621 Glenarm Pl, Denver, CO 80202", 'COLORADO', default_details];
  addresses[12]=[null, "37 Fire Place, Santa Fe, NM 87507", 'NEW MEXICO', default_details];
  addresses[13]=[null, "207 W 18th St., Austin, TX 78701", 'TEXAS', default_details];
  addresses[14]=[null, "8001 South Eastern Avenue, Oklahoma City, OK", 'OKLAHOMA', default_details];
  addresses[15]=[null, "1010 East Broadway Avenue, Pierre, SD 57501", 'SOUTH DAKOTA', default_details];
  /*
   addresses[16]=[null, "10 E Exchange Street, St. Paul, MN 55101", 'MINNESOTA', default_details];
   addresses[17]=[null, "412 E Main Ave, Bismark, ND 58501", 'NORTH DAKOTA', default_details];
   addresses[18]=[null, "128 N 13th St #208, Lincoln, NE 68508", 'NEBRASKA', default_details];
   addresses[19]=[null, "504 East Locust Street, Des Moines, IA 50309", 'IOWA', default_details];
   addresses[20]=[null, "214 SE 8th Avenue, Topeka, KS 66603", 'KANSAS', default_details];
   addresses[21]=[null, "614 President Clinton Avenue, Little Rock, AR 72201", 'ARKANSAS', default_details];
   addresses[22]=[null, "501 Madison Street, Jefferson City, MO 65101", 'MISSOURI', default_details];
   addresses[23]=[null, "502 North New Jersey Street, Indianapolis, IN 46204", 'INDIANA', default_details];
   addresses[24]=[null, "405 Neil Avenue, Columbus, OH 43215", 'OHIO', default_details];
   addresses[25]=[null, "3475 Plymouth Road, Ann Arbor, MI 48105", 'MICHIGAN', default_details];
   addresses[26]=[null, "2090 Atwood Avenue, Madison, WI 53704", 'WISCONSIN', default_details];
   addresses[27]=[null, "2192 Belcourt Avenue, Nashville, TN 37212", 'TENNESSEE', default_details];
   addresses[28]=[null, "420 South 6th Street, Springfield, IL 62701", 'ILLINOIS', default_details];
   addresses[29]=[null, "308 Saint Clair Street, Frankfort, KY 40601", 'KENTUCKY', default_details];
   addresses[30]=[null, "622 Duling Ave., Jackson, MS 39216", 'MISSISSIPPI', default_details];
   addresses[31]=[null, "100 Lafayette St, Baton Rouge, LA 70801", 'LOUISIANA', default_details];
   addresses[32]=[null, "1045 East Fairview Avenue, Montgomery, AL 36106", 'ALABAMA', default_details];
   addresses[33]=[null, "502 South Copeland Streeet, Tallahassee, FL 32306", 'FLORIDA', default_details];
   addresses[34]=[null, "1099 Euclid Avenue NE, Atlanta, GA 30307", 'GEORGIA', default_details];
   addresses[35]=[null, "1515 Main Street, Columbia, SC 29201", 'SOUTH CAROLINA', default_details];
   addresses[36]=[null, "126 East Cabarrus Street, Raleigh, NC 27601", 'NORTH CAROLINA', default_details];
   addresses[37]=[null, "708 East Broad Street, Richmond, VA 23219", 'VIRGINIA', default_details];
   addresses[38]=[null, "1900 Kanawha Boulevard East, Charleston, WV 25305", 'WEST VIRGINIA', default_details];
   addresses[39]=[null, "222 Market Street, Harrisburg, PA 17101", 'PENNSYLVANIA', default_details];
   addresses[40]=[null, "Empire State Plaza, NY, NY 12220", 'NEW YORK', default_details];
   addresses[41]=[null, "36 College Street, Montpelier, VT 05602", 'VERMONT', default_details];
   addresses[42]=[null, "44 South Main Street, Concord, NH 03301", 'NEW HAMPSHIRE', default_details];
   addresses[43]=[null, "60 Pierce Drive, Augusta, ME 04330", 'MAINE', default_details];
   addresses[44]=[null, "136 Massachusetts Ave, Boston, MA 02115", 'MASSACHUSETTS', default_details];
   addresses[45]=[null, "226 South State Street, Dover, DE 19901", 'DELAWARE', default_details];
   addresses[46]=[null, "79 Washington Street, Providence, RI 02903", 'RHODE ISLAND', default_details];
   addresses[47]=[null, "31 Webster Street, Hartford, CT 06114", 'CONNECTICUT', default_details];
   addresses[48]=[null, "205 West State Street, Trenton, NJ 08608", 'NEW JERSEY', default_details];
   addresses[49]=[null, "20 Market Place, Baltimore, MD 21202", 'MARYLAND', default_details];
   addresses[50]=[null, "815 V Street NW, Washington, DC 20001", 'WASHINGTON DC', default_details];
   */
  //  **************************************************************************

  var latlng      = new google.maps.LatLng(0, 0);
  var myOptions   = {zoom: 20, center: latlng, mapTypeId: google.maps.MapTypeId.ROADMAP};
  var map         = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
  var bound       = new google.maps.LatLngBounds();

  for (i = 0; i < addresses.length; i++) {
    var ibOptions = {
      boxClass: 'vidmap-popup'
    }

    var infobox      = new InfoBox(ibOptions),
      geocoder_map   = new google.maps.Geocoder(),
      video_id       = addresses[i][0],
      address        = addresses[i][1],
      state_val      = addresses[i][2],
      details_val    = addresses[i][3]

    var i1 = i;

    // add select list event if video
    (function(video, state_arg) {  // <-- immediate function call
      if (typeof(video) == 'number') {
        listeners[state_val] = function () { jQuery.fn.colorbox({width:"900px", height:"535px", inline:true, href:"#vidpop-details-" + video}); };
        var idx = document.getElementById("vmapSel").length;
        document.getElementById("vmapSel").options[idx]=new Option(state_arg, state_arg);
      }
    }(video_id, state_val)); // <-- immediate function call

    var i2 = i;

    (function(video, addr, state_arg, details_arg) {  // <-- immediate function call
      alert('trying ' + addr);
      geocoder_map.geocode({'address': addr}, function(results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
          var marker = new google.maps.Marker({
            map: map,
            position: results[0].geometry.location,
            shape: shape,
            title: state_arg
          });

          // select appropriate marker image
          if (typeof(video) == 'number') {
            marker.setIcon(markerVideo);
            marker.setShadow(shadowVideo);
          }
          else {
            marker.setIcon(markerNormal);
            marker.setShadow(shadowNormal);
          }

          bound.extend(results[0].geometry.location);
          map.fitBounds(bound);
          map.setCenter(bound.getCenter());

          google.maps.event.addListener(marker, 'click', function() {
            if (typeof(video) == 'number') {
              // numeric; grab the video node
              jQuery.fn.colorbox({width:"900px", height:"535px", inline:true, href:"#vidpop-details-" + video});
            }
            else {
              html = '<div class="state-name">' + state_arg + '</div><div class="details">' + details_arg + '</div>';
              infobox.setContent(html);
              infobox.open(map, marker);
            }
          });
        }
        else {
          alert("The requested address is not mappable: " + addr + ' (' + status + ')');
        }
      });
    } (video_id, address, state_val, details_val)); // <-- immediate function call
    alert('end loop for: ' + address);
  }
  alert('***** past end of loop ********');
}

// click selected marker
function showState(val) {
  if (val != 0) {
    listeners[val]();
  }
}
// -->
</script>
<div id="map_selector" style="width: 980px; margin: 0 auto 5px; text-align: center">
  <select name="list1" id="vmapSel" onChange="javascript:showState(options[selectedIndex].value)">
    <option value="0">- Select State -</option>
  </select>
</div>
<div id="map_canvas" style="width: 980px; height: 475px; border: solid 1px black;"></div>

<script type="text/javascript">
  showmeamap();
</script>
